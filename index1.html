<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</title>
    <style>
    /* ØªÙ†Ø³ÙŠÙ‚ Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø®Ø·ÙˆØ· */
    * {
        box-sizing: border-box;
    }
    
    body {
        direction: rtl;
        font-family: 'Arial', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f9;
        color: #333;
    }

    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‡ÙŠØ¯Ø± Ù„ÙŠØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    header {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
        background-color: #fff;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        position: sticky;
        top: 0;
        z-index: 100;
        gap: 15px;
    }

    .logo {
        font-size: 20px;
        font-weight: bold;
        color: #4CAF50;
        order: 1;
        flex: 1;
        min-width: 150px;
    }

    /* ØªØµÙ…ÙŠÙ… Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ù…ØªØ¬Ø§ÙˆØ¨ */
    .search-bar {
        display: flex;
        order: 2;
        flex: 2;
        min-width: 200px;
        max-width: 500px;
    }
    #search-input {
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px 0 0 5px;
        flex-grow: 1;
        width: 100%;
    }
    .search-bar button {
        padding: 10px 15px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 0 5px 5px 0;
        cursor: pointer;
        white-space: nowrap;
    }

    /* ØªØ­Ø³ÙŠÙ† Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª */
    .cart-container {
        display: flex;
        align-items: center;
        order: 3;
        gap: 10px;
        background: #f9f9f9;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #eee;
    }
    
    .cart-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    
    .cart-total {
        font-size: 14px;
        font-weight: bold;
        color: #e64a19;
    }
    
    .cart-count {
        font-size: 12px;
        color: #666;
    }

    .cart-icon {
        font-size: 24px;
        cursor: pointer;
        position: relative;
        padding: 5px;
    }
    #cart-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: red;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 12px;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø¬Ø³Ù… Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ø£Ù‚Ø³Ø§Ù… */
    main {
        padding: 20px;
    }
    .category-section h2 {
        color: #388e3c;
        border-bottom: 2px solid #ddd;
        padding-bottom: 10px;
        margin-top: 30px;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª (Ø§Ù„Ø´Ø¨ÙƒØ©) */
    .product-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 20px;
        justify-content: center;
    }

    /* ØªØµÙ…ÙŠÙ… Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
    .product-card {
        background-color: white;
        border: 1px solid #eee;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        width: 250px;
        padding: 15px;
        text-align: center;
        transition: transform 0.2s;
    }
    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .product-card img {
        width: 100%;
        height: 150px;
        object-fit: contain;
        border-radius: 5px;
        margin-bottom: 10px;
    }
    .product-info h3 {
        margin: 5px 0;
        font-size: 18px;
        color: #000;
    }
    .price {
        font-weight: bold;
        color: #e64a19;
        font-size: 1.1em;
    }
    .add-to-cart-btn {
        background-color: #FF9800;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        width: 100%;
        transition: background-color 0.2s;
    }
    .add-to-cart-btn:hover {
        background-color: #f57c00;
    }

    /* Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ */
    #cart-sidebar, #checkout-form {
        position: fixed;
        top: 0;
        right: 0;
        width: 350px;
        height: 100%;
        background-color: white;
        box-shadow: -2px 0 5px rgba(0,0,0,0.1);
        padding: 20px;
        overflow-y: auto;
        z-index: 1000;
    }

    .hidden {
        display: none !important;
    }

    .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
    }

    .quantity-control {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .quantity-control button {
        width: 30px;
        height: 30px;
        border: none;
        background-color: #f0f0f0;
        border-radius: 50%;
        cursor: pointer;
    }

    .summary {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 2px solid #eee;
    }

    .total {
        font-weight: bold;
        font-size: 1.2em;
        margin-top: 10px;
    }

    #checkout-button, #send-whatsapp-order {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        margin-top: 15px;
    }

    #get-location-btn {
        background-color: #2196F3;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        margin: 10px 0;
    }

    input[type="text"], input[type="tel"] {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-sizing: border-box;
    }

    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙÙˆØªØ± */
    footer {
        background-color: #333;
        color: white;
        text-align: center;
        padding: 20px;
        margin-top: 50px;
    }
    .footer-links a {
        color: #ccc;
        text-decoration: none;
        margin: 0 10px;
    }
    
    /* Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ÙˆØ³Ø§Ø¦Ø· Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 768px) {
        header {
            flex-direction: column;
            align-items: stretch;
        }
        
        .logo {
            order: 1;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .search-bar {
            order: 2;
            margin-bottom: 10px;
            max-width: 100%;
        }
        
        .cart-container {
            order: 3;
            justify-content: center;
        }
        
        .product-grid {
            justify-content: center;
        }
        
        .product-card {
            width: 100%;
            max-width: 300px;
        }
        
        #cart-sidebar, #checkout-form {
            width: 100%;
        }
    }
    
    @media (max-width: 480px) {
        header {
            padding: 10px 15px;
        }
        
        .logo {
            font-size: 18px;
        }
        
        .cart-container {
            padding: 5px 8px;
        }
        
        .cart-total {
            font-size: 12px;
        }
        
        .cart-count {
            font-size: 10px;
        }
    }
    </style>
</head>
<body>

    <header>
        <div class="logo">Ù…ØªØ¬Ø± Ø§Ù„Ø³Ù„Ø¹ Ø§Ù„Ø·Ø§Ø²Ø¬Ø© ğŸ›’</div>
        
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø£ØµÙ†Ø§Ù...">
            <button>Ø¨Ø­Ø«</button>
        </div>
        
        <div class="cart-container">
            <div class="cart-info">
                <div class="cart-total" id="header-cart-total">0 Ø¯Ø¬</div>
                <div class="cart-count" id="header-cart-count">0 Ù…Ù†ØªØ¬</div>
            </div>
            <div class="cart-icon" id="cart-icon">
                <span id="cart-badge">0</span>
                <span role="img" aria-label="Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª">ğŸ§º</span>
            </div>
        </div>
    </header>

    <main id="main-content">
        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    </main>
    
    <div id="cart-sidebar" class="hidden">
        <h3>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h3>
        <div id="cart-items">
            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ù„Ø© -->
        </div>

        <div class="summary">
            <p>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ: <span id="sub-total">0 Ø¯Ø¬</span></p>
            <p>ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„: <span id="delivery-cost">0 Ø¯Ø¬</span></p>
            <p class="total">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="grand-total">0 Ø¯Ø¬</span></p>
        </div>
        
        <button id="checkout-button">Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡</button>
        <button id="close-cart">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <div id="checkout-form" class="hidden">
        <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
        <input type="text" id="customer-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
        <input type="tel" id="customer-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
        
        <button id="get-location-btn">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ (Ù„Ù„ØªÙˆØµÙŠÙ„)</button>
        <p id="location-status" style="color: green; margin-top: 10px;"></p>

        <p class="total">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ù…Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„: <span id="final-total">0 Ø¯Ø¬</span></p>

        <button id="send-whatsapp-order">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ÙŠØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <button id="back-to-cart">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
    </div>

    <footer>
        <p>&copy; 2024 Ù…ØªØ¬Ø± Ø§Ù„Ø³Ù„Ø¹ Ø§Ù„Ø·Ø§Ø²Ø¬Ø©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
        <div class="footer-links">
            <a href="#">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a> | 
            <a href="#">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
        </div>
    </footer>

    <script>
    // A. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    let cart = []; // Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙØ§Ø±ØºØ© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
    let products = []; // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    const STORE_LAT = 36.7538; // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø«Ø§Ø¨ØªØ©
    const STORE_LON = 3.0588;
    let customerLocation = null; // Ù„ØªØ®Ø²ÙŠÙ† Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
    let deliveryCost = 0;

    // B. Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Google Sheets
    async function fetchProducts() {
        try {
            // Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ØªÙˆÙØ± Google Sheets
            products = [
                { id: 'P001', ØµÙ†Ù: 'Ø²ÙŠØª Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', Ø§Ø³Ù…: 'Ø²ÙŠØª Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ 5 Ù„ØªØ±', Ø³Ø¹Ø±: 2500, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø²ÙŠØªØŒ Ø·Ø¨Ø®', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø²ÙŠØª+5Ù„ØªØ±' },
                { id: 'P002', ØµÙ†Ù: 'Ø²ÙŠØª Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', Ø§Ø³Ù…: 'Ø²ÙŠØª Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ 2 Ù„ØªØ±', Ø³Ø¹Ø±: 1000, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø²ÙŠØªØŒ Ø·Ø¨Ø®', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø²ÙŠØª+2Ù„ØªØ±' },
                { id: 'P003', ØµÙ†Ù: 'Ø§Ù„Ù…Ø¹Ù„Ø¨Ø§Øª', Ø§Ø³Ù…: 'Ø¹Ù„Ø¨Ø© ØªÙˆÙ†Ø© Ø¨Ø§Ù„Ø²ÙŠØª', Ø³Ø¹Ø±: 150, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'ØªÙˆÙ†Ø©ØŒ Ø³Ù…Ùƒ', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=ØªÙˆÙ†Ø©' },
                { id: 'P004', ØµÙ†Ù: 'Ø§Ù„Ù…Ø¹Ù„Ø¨Ø§Øª', Ø§Ø³Ù…: 'ÙØ§ØµÙˆÙ„ÙŠØ§ Ù…Ø¹Ù„Ø¨Ø©', Ø³Ø¹Ø±: 80, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'ÙØ§ØµÙˆÙ„ÙŠØ§ØŒ Ù…Ø¹Ù„Ø¨Ø§Øª', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=ÙØ§ØµÙˆÙ„ÙŠØ§' },
                { id: 'P005', ØµÙ†Ù: 'Ø§Ù„Ø­Ø¨ÙˆØ¨', Ø§Ø³Ù…: 'Ø£Ø±Ø² Ø¨Ø³Ù…ØªÙŠ 5 ÙƒØºÙ…', Ø³Ø¹Ø±: 1200, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø£Ø±Ø²ØŒ Ø­Ø¨ÙˆØ¨', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø£Ø±Ø²' },
                { id: 'P006', ØµÙ†Ù: 'Ø§Ù„Ø­Ø¨ÙˆØ¨', Ø§Ø³Ù…: 'Ø¹Ø¯Ø³ Ø£ØµÙØ± 1 ÙƒØºÙ…', Ø³Ø¹Ø±: 300, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø¹Ø¯Ø³ØŒ Ø­Ø¨ÙˆØ¨', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø¹Ø¯Ø³' }
            ];
            
            renderProducts(products);
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', error);
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø­Ø¯ÙˆØ« Ø®Ø·Ø£
            products = [
                { id: 'P001', ØµÙ†Ù: 'Ø²ÙŠØª Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', Ø§Ø³Ù…: 'Ø²ÙŠØª Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ 5 Ù„ØªØ±', Ø³Ø¹Ø±: 2500, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø²ÙŠØªØŒ Ø·Ø¨Ø®', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø²ÙŠØª+5Ù„ØªØ±' },
                { id: 'P002', ØµÙ†Ù: 'Ø²ÙŠØª Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©', Ø§Ø³Ù…: 'Ø²ÙŠØª Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³ 2 Ù„ØªØ±', Ø³Ø¹Ø±: 1000, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'Ø²ÙŠØªØŒ Ø·Ø¨Ø®', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=Ø²ÙŠØª+2Ù„ØªØ±' },
                { id: 'P003', ØµÙ†Ù: 'Ø§Ù„Ù…Ø¹Ù„Ø¨Ø§Øª', Ø§Ø³Ù…: 'Ø¹Ù„Ø¨Ø© ØªÙˆÙ†Ø© Ø¨Ø§Ù„Ø²ÙŠØª', Ø³Ø¹Ø±: 150, ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©: 'ØªÙˆÙ†Ø©ØŒ Ø³Ù…Ùƒ', ØµÙˆØ±Ø©: 'https://via.placeholder.com/250x150?text=ØªÙˆÙ†Ø©' }
            ];
            renderProducts(products);
        }
    }

    // C. Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    function renderProducts(productsToRender) {
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = '';
        
        // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØµÙ†Ù
        const categories = {};
        productsToRender.forEach(product => {
            if (!categories[product.ØµÙ†Ù]) {
                categories[product.ØµÙ†Ù] = [];
            }
            categories[product.ØµÙ†Ù].push(product);
        });
        
        // ØªÙˆÙ„ÙŠØ¯ HTML Ù„ÙƒÙ„ ØµÙ†Ù
        Object.keys(categories).forEach(category => {
            const section = document.createElement('section');
            section.className = 'category-section';
            section.id = `${category.replace(/\s+/g, '-')}-category`;
            
            const heading = document.createElement('h2');
            heading.textContent = category;
            section.appendChild(heading);
            
            const productGrid = document.createElement('div');
            productGrid.className = 'product-grid';
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            categories[category].forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                productCard.innerHTML = `
                    <img src="${product.ØµÙˆØ±Ø©}" alt="${product.Ø§Ø³Ù…}" onerror="this.src='https://via.placeholder.com/250x150?text=ØµÙˆØ±Ø©+ØºÙŠØ±+Ù…ØªÙˆÙØ±Ø©'">
                    <div class="product-info">
                        <h3>${product.Ø§Ø³Ù…}</h3>
                        <p class="category-tag">Ø§Ù„ØµÙ†Ù: ${product.ØµÙ†Ù}</p>
                        <p class="price">${parseInt(product.Ø³Ø¹Ø±).toLocaleString()} Ø¯Ø¬</p>
                    </div>
                    <button class="add-to-cart-btn" data-product-id="${product.id}">â• Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
                `;
                
                productGrid.appendChild(productCard);
            });
            
            section.appendChild(productGrid);
            mainContent.appendChild(section);
            
            // Ø¥Ø¶Ø§ÙØ© Ø®Ø· ÙØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            if (Object.keys(categories).indexOf(category) < Object.keys(categories).length - 1) {
                const hr = document.createElement('hr');
                mainContent.appendChild(hr);
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
        document.querySelectorAll('.add-to-cart-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                handleAddToCart(e.target.getAttribute('data-product-id'));
            });
        });
    }

    // D. Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
    function handleAddToCart(productId) {
        const product = products.find(p => p.id === productId);
        
        if (!product) return;
        
        const existingItem = cart.find(item => item.id === productId);
        
        if (existingItem) {
            existingItem.quantity += 1;
        } else {
            cart.push({
                id: product.id,
                Ø§Ø³Ù…: product.Ø§Ø³Ù…,
                Ø³Ø¹Ø±: parseInt(product.Ø³Ø¹Ø±),
                quantity: 1,
                ØµÙ†Ù: product.ØµÙ†Ù
            });
        }
        
        updateCartDisplay();
        showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${product.Ø§Ø³Ù…} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`);
    }

    // E. Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ
    function updateCartDisplay() {
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ
        const subTotal = cart.reduce((total, item) => total + (item.sØ¹Ø± * item.quantity), 0);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡ÙŠØ¯Ø±
        document.getElementById('header-cart-total').textContent = subTotal.toLocaleString() + ' Ø¯Ø¬';
        document.getElementById('header-cart-count').textContent = cart.reduce((total, item) => total + item.quantity, 0) + ' Ù…Ù†ØªØ¬';
        document.getElementById('cart-badge').textContent = cart.reduce((total, item) => total + item.quantity, 0);
        
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø³Ù„Ø©
        const cartItemsContainer = document.getElementById('cart-items');
        cartItemsContainer.innerHTML = '';
        
        if (cart.length === 0) {
            cartItemsContainer.innerHTML = '<p>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>';
        } else {
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div>
                        <strong>${item.Ø§Ø³Ù…}</strong>
                        <div class="quantity-control">
                            <button class="quantity-minus" data-product-id="${item.id}">-</button>
                            <span class="current-quantity">${item.quantity}</span>
                            <button class="quantity-plus" data-product-id="${item.id}">+</button>
                        </div>
                    </div>
                    <span>${(item.sØ¹Ø± * item.quantity).toLocaleString()} Ø¯Ø¬</span>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙƒÙ…ÙŠØ©
            document.querySelectorAll('.quantity-minus').forEach(button => {
                button.addEventListener('click', (e) => {
                    handleQuantityChange(e.target.getAttribute('data-product-id'), -1);
                });
            });
            
            document.querySelectorAll('.quantity-plus').forEach(button => {
                button.addEventListener('click', (e) => {
                    handleQuantityChange(e.target.getAttribute('data-product-id'), 1);
                });
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ ÙÙŠ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚
        document.getElementById('sub-total').textContent = subTotal.toLocaleString() + ' Ø¯Ø¬';
        
        const grandTotal = subTotal + deliveryCost;
        document.getElementById('grand-total').textContent = grandTotal.toLocaleString() + ' Ø¯Ø¬';
        document.getElementById('final-total').textContent = grandTotal.toLocaleString() + ' Ø¯Ø¬';
        
        document.getElementById('delivery-cost').textContent = deliveryCost.toLocaleString() + ' Ø¯Ø¬';
    }

    // F. Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø³Ù„Ø©
    function handleQuantityChange(productId, delta) {
        const item = cart.find(item => item.id === productId);
        
        if (item) {
            item.quantity += delta;
            
            if (item.quantity <= 0) {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙƒÙ…ÙŠØ© ØµÙØ±
                cart = cart.filter(i => i.id !== productId);
                showNotification(`ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© ${item.Ø§Ø³Ù…} Ù…Ù† Ø§Ù„Ø³Ù„Ø©`);
            }
            
            updateCartDisplay();
        }
    }

    // G. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    function setupSearch() {
        const searchInput = document.getElementById('search-input');
        const searchButton = document.querySelector('.search-bar button');
        
        const performSearch = () => {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                renderProducts(products);
                return;
            }
            
            const filteredProducts = products.filter(product => {
                return (
                    product.Ø§Ø³Ù….toLowerCase().includes(searchTerm) ||
                    product.ØµÙ†Ù.toLowerCase().includes(searchTerm) ||
                    (product.ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ© && product.ÙƒÙ„Ù…Ø§Øª_Ù…ÙØªØ§Ø­ÙŠØ©.toLowerCase().includes(searchTerm))
                );
            });
            
            renderProducts(filteredProducts);
        };
        
        searchInput.addEventListener('input', performSearch);
        searchButton.addEventListener('click', performSearch);
    }

    // H. Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ù…ÙˆÙ‚Ø¹ÙŠÙ†
    function calculateDistance(lat1, lon1, lat2, lon2) {
        // ØµÙŠØºØ© Haversine Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ù†Ù‚Ø·ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø£Ø±Ø¶ÙŠØ©
        const R = 6371; // Ù†ØµÙ Ù‚Ø·Ø± Ø§Ù„Ø£Ø±Ø¶ Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙ…ØªØ±Ø§Øª
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        const distance = R * c; // Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙ…ØªØ±Ø§Øª
        return distance;
    }

    // I. Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
    function setupLocationDetection() {
        const getLocationBtn = document.getElementById('get-location-btn');
        
        getLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const customerLat = position.coords.latitude;
                        const customerLon = position.coords.longitude;
                        customerLocation = { lat: customerLat, lon: customerLon };

                        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
                        const distanceKm = calculateDistance(STORE_LAT, STORE_LON, customerLat, customerLon);
                        
                        // ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©
                        const BASE_FEE = 300; // Ø¯Ø¬
                        const FREE_DISTANCE = 5; // ÙƒÙ…
                        const RATE_PER_KM = 50; // Ø¯Ø¬
                        
                        deliveryCost = BASE_FEE + Math.max(0, distanceKm - FREE_DISTANCE) * RATE_PER_KM;
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                        document.getElementById('location-status').textContent = `âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹. Ø§Ù„Ù…Ø³Ø§ÙØ©: ${distanceKm.toFixed(2)} ÙƒÙ….`;
                        updateCartDisplay();
                    },
                    (error) => {
                        // Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø¥Ø°Ø§ Ø±ÙØ¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø´Ø§Ø±ÙƒØ© Ù…ÙˆÙ‚Ø¹Ù‡
                        alert("ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„Ø­Ø³Ø§Ø¨ ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„.");
                        deliveryCost = 500; // Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø±ÙØ¶
                        document.getElementById('location-status').textContent = `âš ï¸ ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠØ©: ${deliveryCost} Ø¯Ø¬`;
                        updateCartDisplay();
                    }
                );
            } else {
                alert("Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ.");
            }
        });
    }

    // J. Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
    function setupWhatsAppIntegration() {
        const sendWhatsappBtn = document.getElementById('send-whatsapp-order');

        sendWhatsappBtn.addEventListener('click', () => {
            const customerName = document.getElementById('customer-name').value;
            const customerPhone = document.getElementById('customer-phone').value;
            
            if (!customerName || !customerPhone) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ.");
                return;
            }
            
            if (!customerLocation) {
                alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„ØªØ­Ø¯ÙŠØ¯ ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„.");
                return;
            }
            
            // Ø¨Ù†Ø§Ø¡ Ù†Øµ Ø§Ù„Ø·Ù„Ø¨ÙŠØ© Ù…ÙØµÙ‘Ù„
            let orderDetails = '';
            cart.forEach(item => {
                const itemTotal = item.sØ¹Ø± * item.quantity;
                orderDetails += `- ${item.Ø§Ø³Ù…} (${item.quantity} Ã— ${item.sØ¹Ø±.toLocaleString()} Ø¯Ø¬) = ${itemTotal.toLocaleString()} Ø¯Ø¬\n`;
            });
            
            const subTotal = cart.reduce((total, item) => total + (item.sØ¹Ø± * item.quantity), 0);
            const totalCost = subTotal + deliveryCost;

            // Ø¨Ù†Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©
            const message = `
ğŸ›’ *Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© - Ù…ØªØ¬Ø± Ø§Ù„Ø³Ù„Ø¹ Ø§Ù„Ø·Ø§Ø²Ø¬Ø©*

ğŸ‘¤ *Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†:*
- Ø§Ù„Ø§Ø³Ù…: ${customerName}
- Ø§Ù„Ù‡Ø§ØªÙ: ${customerPhone}

ğŸ“‹ *ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©:*
${orderDetails}

ğŸ’° *Ø§Ù„ØªÙƒÙ„ÙØ©:*
- Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ: ${subTotal.toLocaleString()} Ø¯Ø¬
- ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„: ${deliveryCost.toLocaleString()} Ø¯Ø¬
- *Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${totalCost.toLocaleString()} Ø¯Ø¬*

ğŸ“ *Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„:*
https://www.google.com/maps/search/?api=1&query=${customerLocation.lat},${customerLocation.lon}

â° *ÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨:* ${new Date().toLocaleString('ar-EG')}

Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±ÙƒÙ… Ù…ØªØ¬Ø± Ø§Ù„Ø³Ù„Ø¹ Ø§Ù„Ø·Ø§Ø²Ø¬Ø©!
            `;

            // ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù€ URL
            const encodedMessage = encodeURIComponent(message);
            // Ø§Ø³ØªØ¨Ø¯Ù„ XXXXXXX Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„Ù…ØªØ¬Ø±
            const whatsappURL = `https://wa.me/213123456789?text=${encodedMessage}`;
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            window.open(whatsappURL, '_blank');
        });
    }

    // K. Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function setupUIHandlers() {
        // ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚
        document.getElementById('cart-icon').addEventListener('click', () => {
            document.getElementById('cart-sidebar').classList.remove('hidden');
        });
        
        document.getElementById('close-cart').addEventListener('click', () => {
            document.getElementById('cart-sidebar').classList.add('hidden');
        });
        
        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù…Ù† Ø§Ù„Ø³Ù„Ø© Ø¥Ù„Ù‰ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯ÙØ¹
        document.getElementById('checkout-button').addEventListener('click', () => {
            if (cart.length === 0) {
                alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©. Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø¨Ù„ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡.");
                return;
            }
            
            document.getElementById('cart-sidebar').classList.add('hidden');
            document.getElementById('checkout-form').classList.remove('hidden');
        });
        
        // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯ÙØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
        document.getElementById('back-to-cart').addEventListener('click', () => {
            document.getElementById('checkout-form').classList.add('hidden');
            document.getElementById('cart-sidebar').classList.remove('hidden');
        });
    }

    // L. Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
    function showNotification(message) {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
        const notification = document.createElement('div');
        notification.textContent = message;
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10000;
            transition: opacity 0.3s;
        `;
        
        document.body.appendChild(notification);
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
        setTimeout(() => {
            notification.style.opacity = '0';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // M. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
        fetchProducts();
        setupSearch();
        setupLocationDetection();
        setupWhatsAppIntegration();
        setupUIHandlers();
    });
    </script>
</body>
</html>