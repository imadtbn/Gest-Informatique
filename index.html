<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุชุฌุฑ ุงูููุงุฏ ุงูุบุฐุงุฆูุฉ</title>
    <link rel="stylesheet" href="style.css">
    <style>
    /* ุชูุณูู ุฃุณุงุณู ููุนุฑุจูุฉ ูุงูุฎุทูุท */
body {
    direction: rtl;
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f9;
    color: #333;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 40px;
    background-color: #fff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
}

.logo {
    font-size: 24px;
    font-weight: bold;
    color: #4CAF50; /* ููู ุฌุฐุงุจ ููุฃุบุฐูุฉ */
}

/* ุชุตููู ุดุฑูุท ุงูุจุญุซ */
.search-bar {
    display: flex;
    width: 40%;
}
#search-input {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px 0 0 5px;
    flex-grow: 1;
}
.search-bar button {
    padding: 10px 15px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 0 5px 5px 0;
    cursor: pointer;
}

/* ุฃููููุฉ ุงูุณูุฉ */
.cart-icon {
    font-size: 24px;
    cursor: pointer;
    position: relative;
    padding: 5px;
}
#cart-count {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: red;
    color: white;
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 12px;
}

/* ุชูุณูู ุฌุณู ุงูุตูุญุฉ ูุงูุฃูุณุงู */
main {
    padding: 20px 40px;
}
.category-section h2 {
    color: #388e3c;
    border-bottom: 2px solid #ddd;
    padding-bottom: 10px;
    margin-top: 30px;
}

/* ุชูุณูู ุนุฑุถ ุงูุจุทุงูุงุช (ุงูุดุจูุฉ) */
.product-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
}

/* ุชุตููู ุจุทุงูุฉ ุงูููุชุฌ (ุงูููุฒุฉ ุงููุทููุจุฉ) */
.product-card {
    background-color: white;
    border: 1px solid #eee;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    width: 250px;
    padding: 15px;
    text-align: center;
    transition: transform 0.2s;
}
.product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
.product-card img {
    width: 100%;
    height: 150px;
    object-fit: contain; /* ูุถูุงู ุธููุฑ ุงูููุชุฌ ูุงููุงู */
    border-radius: 5px;
    margin-bottom: 10px;
}
.product-info h3 {
    margin: 5px 0;
    font-size: 18px;
    color: #000;
}
.price {
    font-weight: bold;
    color: #e64a19; /* ููู ุงูุณุนุฑ */
    font-size: 1.1em;
}
.add-to-cart-btn {
    background-color: #FF9800; /* ุฒุฑ ุดุฑุงุก ุฌุฐุงุจ */
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
    transition: background-color 0.2s;
}
.add-to-cart-btn:hover {
    background-color: #f57c00;
}

/* ุณูุฉ ุงููุดุชุฑูุงุช ูุตูุญุฉ ุงูุฏูุน (ูุฎููุฉ ูู ุงูุจุฏุงูุฉ) */
.hidden {
    display: none !important;
}

/* ุชูุณูู ุงูููุชุฑ */
footer {
    background-color: #333;
    color: white;
    text-align: center;
    padding: 20px;
    margin-top: 50px;
}
.footer-links a {
    color: #ccc;
    text-decoration: none;
    margin: 0 10px;
}
    </style>
    
</head>
<body>

    <header>
        <div class="logo">ูุชุฌุฑ ุงูุณูุน ุงูุทุงุฒุฌุฉ ๐</div>
        
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="ุงุจุญุซ ุนู ุงูููุชุฌุงุช ุฃู ุงูุฃุตูุงู...">
            <button>ุจุญุซ</button>
        </div>
        
        <div class="cart-icon">
            <span id="cart-count">0</span>
            <span role="img" aria-label="ุณูุฉ ุงููุดุชุฑูุงุช">๐งบ</span>
        </div>
    </header>

    <main>
        <section class="category-section" id="oil-category">
            <h2>ุฒูุช ุงููุงุฆุฏุฉ</h2>
            <div class="product-grid">
                <div class="product-card">
                    <img src="placeholder-oil-5l.jpg" alt="ุฒูุช 5 ูุชุฑ">
                    <div class="product-info">
                        <h3>ุฒูุช ุนุจุงุฏ ุงูุดูุณ 5 ูุชุฑ</h3>
                        <p class="category-tag">ุงูุตูู: ุฒูุช ุงููุงุฆุฏุฉ</p>
                        <p class="price">2500 ุฏุฌ</p>
                    </div>
                    <button class="add-to-cart-btn" data-product-id="P001">โ ุฃุถู ุฅูู ุงูุณูุฉ</button>
                </div>

                <div class="product-card">
                    <img src="placeholder-oil-2l.jpg" alt="ุฒูุช 2 ูุชุฑ">
                    <div class="product-info">
                        <h3>ุฒูุช ุนุจุงุฏ ุงูุดูุณ 2 ูุชุฑ</h3>
                        <p class="category-tag">ุงูุตูู: ุฒูุช ุงููุงุฆุฏุฉ</p>
                        <p class="price">1000 ุฏุฌ</p>
                    </div>
                    <button class="add-to-cart-btn" data-product-id="P002">โ ุฃุถู ุฅูู ุงูุณูุฉ</button>
                </div>
                </div>
        </section>

        <hr>

        <section class="category-section" id="canned-category">
            <h2>ุงููุนูุจุงุช</h2>
            <div class="product-grid">
                <div class="product-card">
                    <img src="placeholder-tuna.jpg" alt="ุนูุจุฉ ุชููุฉ">
                    <div class="product-info">
                        <h3>ุนูุจุฉ ุชููุฉ ุจุงูุฒูุช</h3>
                        <p class="category-tag">ุงูุตูู: ุงููุนูุจุงุช</p>
                        <p class="price">150 ุฏุฌ</p>
                    </div>
                    <button class="add-to-cart-btn" data-product-id="P003">โ ุฃุถู ุฅูู ุงูุณูุฉ</button>
                </div>
            </div>
        </section>
        
    </main>
    
    <div id="cart-sidebar" class="hidden">
        <h3>ุณูุฉ ุงููุดุชุฑูุงุช</h3>
        <ul id="cart-items">
            <li>
                ุฒูุช 5 ูุชุฑ x 1
                <div class="quantity-control">
                    <button class="quantity-minus">-</button>
                    <span class="current-quantity">1</span>
                    <button class="quantity-plus">+</button>
                </div>
                <span>2500 ุฏุฌ</span>
            </li>
        </ul>

        <div class="summary">
            <p>ุงููุฌููุน ุงููุฑุนู: <span id="sub-total">2500 ุฏุฌ</span></p>
            <p>ุชูููุฉ ุงูุชูุตูู: <span id="delivery-cost">...</span></p>
            <p class="total">ุงููุฌููุน ุงูููู: <span id="grand-total">...</span></p>
        </div>
        
        <button id="checkout-button">ุฅุชูุงู ุนูููุฉ ุงูุดุฑุงุก</button>
    </div>

    <div id="checkout-form" class="hidden">
        <h3>ุจูุงูุงุช ุงูุชูุตูู</h3>
        <input type="text" id="customer-name" placeholder="ุงูุงุณู ุงููุงูู" required>
        <input type="tel" id="customer-phone" placeholder="ุฑูู ุงููุงุชู" required>
        
        <button id="get-location-btn">๐ ุชุญุฏูุฏ ูููุนู ุงูุฌุบุฑุงูู (ููุชูุตูู)</button>
        <p id="location-status" style="color: green; margin-top: 10px;"></p>

        <p class="total">ุงููุฌููุน ุงูููู ูุน ุงูุชูุตูู: <span id="final-total">...</span></p>

        <button id="send-whatsapp-order">ุฅุฑุณุงู ุงูุทูุจูุฉ ุนุจุฑ ูุงุชุณุงุจ</button>
    </div>

    <footer>
        <p>&copy; 2024 ูุชุฌุฑ ุงูุณูุน ุงูุทุงุฒุฌุฉ. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
        <div class="footer-links">
            <a href="#">ุณูุงุณุฉ ุงูุฎุตูุตูุฉ</a> | 
            <a href="#">ุดุฑูุท ุงูุงุณุชุฎุฏุงู</a>
        </div>
        <div class="social-media">
            </div>
    </footer>
    <script>
    
    // A. ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช ุงูุฑุฆูุณูุฉ
let cart = []; // ุณูุฉ ุงููุดุชุฑูุงุช ูุงุฑุบุฉ ูู ุงูุจุฏุงูุฉ
const STORE_LAT = 36.7538; // ุฅุญุฏุงุซูุงุช ุงููุชุฌุฑ ุงูุซุงุจุชุฉ
const STORE_LON = 3.0588;

// B. ุฏุงูุฉ ุฌูุจ ุงูููุชุฌุงุช ูู Google Sheets
async function fetchProducts() {
    // 1. **ุงูุฑุจุท ุจุงููุฑูุฉ:** (ูุชู ููุง ุงุณุชุฎุฏุงู Google Sheets API ุฃู Google Apps Script)
    //    const response = await fetch('YOUR_GOOGLE_SHEET_API_URL');
    //    const productsData = await response.json();
    
    // 2. **ูุซุงู ุนูู ุงูุจูุงูุงุช (ููุชุฌุฑูุจ):**
    const productsData = [
        { id: 'P001', ุตูู: 'ุฒูุช ุงููุงุฆุฏุฉ', ุงุณู: 'ุฒูุช ุนุจุงุฏ ุงูุดูุณ 5 ู', ุณุนุฑ: 2500, ูููุงุช_ููุชุงุญูุฉ: 'ุฒูุชุ ุทุจุฎ', ุตูุฑุฉ: 'oil-5l.jpg' },
        { id: 'P002', ุตูู: 'ุฒูุช ุงููุงุฆุฏุฉ', ุงุณู: 'ุฒูุช ุนุจุงุฏ ุงูุดูุณ 2 ู', ุณุนุฑ: 1000, ูููุงุช_ููุชุงุญูุฉ: 'ุฒูุชุ ุทุจุฎ', ุตูุฑุฉ: 'oil-2l.jpg' },
        { id: 'P003', ุตูู: 'ุงููุนูุจุงุช', ุงุณู: 'ุนูุจุฉ ุชููุฉ ุจุงูุฒูุช', ุณุนุฑ: 150, ูููุงุช_ููุชุงุญูุฉ: 'ุชููุฉุ ุณูู', ุตูุฑุฉ: 'tuna.jpg' },
        // ... ุจูุงูุงุช ุฃุฎุฑู ูู ูุฑูุฉ ุฌูุฌู ุดูุช ...
    ];

    renderProducts(productsData);
}

// C. ุฏุงูุฉ ุนุฑุถ ุงูููุชุฌุงุช ูู ุงููุงุฌูุฉ
function renderProducts(products) {
    // 1. **ุชุฌููุน ุงูููุชุฌุงุช ุญุณุจ ุงูุตูู:** //    ูุชู ุฅูุดุงุก ูุงุฆู (Object) ุญูุซ ูููู ุงูููุชุงุญ ูู ุงูุตูู ูุงููููุฉ ูู ูุงุฆูุฉ ุงูููุชุฌุงุช ุงูุชุงุจุนุฉ ูู.
    
    // 2. **ุชูููุฏ HTML:** ูุชู ุฅูุดุงุก ุฃูุณุงู <section class="category-section">
    //    ูุจุฏุงุฎููุง ูุชู ุชูููุฏ <div class="product-card"> ููู ููุชุฌ ุจุดูู ุฏููุงูููู.
    
    // 3. **ุฅุถุงูุฉ ูุณุชูุน ุงูุญุฏุซ (Event Listener):** //    ููู ุฒุฑ "ุฃุถู ุฅูู ุงูุณูุฉ" ูุชู ุฑุจุทู ุจุงูุฏุงูุฉ: handleAddToCart(product.id);
}

// ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
fetchProducts();
    
    // A. ุฏุงูุฉ ุฅุถุงูุฉ ุงูููุชุฌ ุฅูู ุงูุณูุฉ
function handleAddToCart(productId) {
    // 1. ุงูุจุญุซ ุนู ุงูููุชุฌ ูู ูุงุฆูุฉ ุงูููุชุฌุงุช ุงููุชุงุญุฉ.
    // 2. ูุญุต: ูู ุงูููุชุฌ ููุฌูุฏ ุจุงููุนู ูู ูุตูููุฉ 'cart'ุ
    if (cart.find(item => item.id === productId)) {
        // ุฅุฐุง ูุงู ููุฌูุฏุงู: ุฒูุงุฏุฉ ุงููููุฉ (+1).
        // item.quantity++;
    } else {
        // ุฅุฐุง ูู ููู ููุฌูุฏุงู: ุฅุถุงูุชู ุฅูู ูุตูููุฉ 'cart' ุจุงููููุฉ (1).
        // cart.push({ id: productId, quantity: 1, ...otherDetails });
    }
    
    updateCartDisplay();
}

// B. ุฏุงูุฉ ุชุญุฏูุซ ุนุฑุถ ุงูุณูุฉ ูุงููุฌููุน ุงูููู
function updateCartDisplay() {
    // 1. ุชุญุฏูุซ ุนุฏุงุฏ ุงูุณูุฉ ูู ุงูููุฏุฑ: cart-count.innerHTML = cart.length;
    
    // 2. ุญุณุงุจ ุงููุฌููุน ุงููุฑุนู (Sub-total):
    //    let subTotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
    //    subTotalElement.innerHTML = subTotal + ' ุฏุฌ';

    // 3. ุชุญุฏูุซ ูุงุฆูุฉ ุงูููุชุฌุงุช ุฏุงุฎู ุงูุณูุฉ (cart-sidebar)
    //    ูุชู ุชูููุฏ ุนูุงุตุฑ <li> ุฌุฏูุฏุฉ ููู ููุชุฌ ูู 'cart' ูุน ุฃุฒุฑุงุฑ (+) ู (-).
    
    // 4. ุฑุจุท ุงูุฃุฒุฑุงุฑ ุงูุฏููุงููููุฉ:
    //    ููู ุฒุฑ (+) ู (-)ุ ูุชู ุฑุจุทู ุจุฏุงูุฉ ูุซู: handleQuantityChange(itemId, delta);
}
    
    const searchInput = document.getElementById('search-input');

searchInput.addEventListener('input', function() {
    const searchTerm = searchInput.value.toLowerCase();
    
    // 1. **ููุชุฑุฉ ุงูููุชุฌุงุช:**
    //    ูุชู ููุชุฑุฉ ูุงุฆูุฉ ุงูููุชุฌุงุช ุงูุฃุตููุฉ (ุงูุชู ุชู ุฌูุจูุง ูู Google Sheets).
    
    // 2. **ูุนูุงุฑ ุงูุจุญุซ:** ูุฌุจ ุฃู ูุชุทุงุจู 'searchTerm' ูุน:
    //    - ุงุณู_ุงูููุชุฌ.
    //    - ุงูุตูู_ุงูุฑุฆูุณู.
    //    - ุฃู ูู ุงููููุงุช_ุงูููุชุงุญูุฉ.
    
    // 3. **ุฅุนุงุฏุฉ ุงูุนุฑุถ:**
    //    renderProducts(filteredProducts); // ุฅุนุงุฏุฉ ุนุฑุถ ููุท ุงูููุชุฌุงุช ุงููุทุงุจูุฉ.
});
    
    const getLocationBtn = document.getElementById('get-location-btn');
let customerLocation = null; // ูุชุฎุฒูู ุฅุญุฏุงุซูุงุช ุงูุนููู
let deliveryCost = 0;

getLocationBtn.addEventListener('click', () => {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            async (position) => {
                const customerLat = position.coords.latitude;
                const customerLon = position.coords.longitude;
                customerLocation = { lat: customerLat, lon: customerLon };

                // A. ุญุณุงุจ ุงููุณุงูุฉ (ูุชุทูุจ Google Maps API Key)
                // ูุชู ุงุณุชุฏุนุงุก ุฏุงูุฉ ุชุญุณุจ ุงููุณุงูุฉ ุจูู (STORE_LAT, STORE_LON) ู (customerLat, customerLon)
                const distanceKm = await calculateDistance(STORE_LAT, STORE_LON, customerLat, customerLon);
                
                // B. ุชุทุจูู ูุนุงุฏูุฉ ุงูุชุณุนูุฑ (ููุง ุงุชูููุง)
                const BASE_FEE = 300; // ุฏุฌ
                const FREE_DISTANCE = 5; // ูู
                const RATE_PER_KM = 50; // ุฏุฌ
                
                deliveryCost = BASE_FEE + Math.max(0, distanceKm - FREE_DISTANCE) * RATE_PER_KM;
                
                // C. ุชุญุฏูุซ ุงููุงุฌูุฉ
                document.getElementById('location-status').innerText = `โ ุชู ุชุญุฏูุฏ ุงููููุน. ุงููุณุงูุฉ: ${distanceKm.toFixed(2)} ูู.`;
                updateFinalTotal();
            },
            (error) => {
                // ุฑุณุงูุฉ ุฎุทุฃ ุฅุฐุง ุฑูุถ ุงููุณุชุฎุฏู ูุดุงุฑูุฉ ูููุนู
                alert("ูุฑุฌู ุชูุนูู ุงููููุน ุงูุฌุบุฑุงูู ูุญุณุงุจ ุชูููุฉ ุงูุชูุตูู.");
                deliveryCost = 500; // ุฑุณูู ุชูุตูู ุงูุชุฑุงุถูุฉ ูู ุญุงูุฉ ุงูุฑูุถ
                updateFinalTotal();
            }
        );
    } else {
        alert("ูุชุตูุญู ูุง ูุฏุนู ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู.");
    }
});

function updateFinalTotal() {
    // 1. ูุชู ุฌูุน ุงููุฌููุน ุงููุฑุนู + deliveryCost
    // 2. ุชุญุฏูุซ ุงูุนูุงุตุฑ: id="final-total" ู id="delivery-cost"
}
    
    const sendWhatsappBtn = document.getElementById('send-whatsapp-order');

sendWhatsappBtn.addEventListener('click', () => {
    const customerName = document.getElementById('customer-name').value;
    const customerPhone = document.getElementById('customer-phone').value;
    
    if (!customerName || !customerPhone || !customerLocation) {
        alert("ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู ูุฑูู ุงููุงุชู ูุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู.");
        return;
    }
    
    // 1. ุจูุงุก ูุต ุงูุทูุจูุฉ (ุจุงูุงุณุชูุงุฏุฉ ูู ุงูุจูุงูุงุช ูู ูุตูููุฉ 'cart')
    let orderDetails = cart.map(item => `${item.ุงุณู} x ${item.quantity} (${item.price * item.quantity} ุฏุฌ)`).join('\n');

    const totalCost = parseFloat(document.getElementById('grand-total').innerText); // ุณุญุจ ุงููุจูุบ ุงูููุงุฆู

    // 2. ุจูุงุก ุฑุณุงูุฉ ุงููุงุชุณุงุจ ุงูููุงุฆูุฉ
    const message = `
*ุทูุจูุฉ ุฌุฏูุฏุฉ ููููุงุฏ ุงูุบุฐุงุฆูุฉ:*
----------------------------------
*ุงูุฒุจูู:* ${customerName}
*ุงููุงุชู:* ${customerPhone}

*ุชูุงุตูู ุงูุทูุจ:*
${orderDetails}

----------------------------------
*ุงููุฌููุน ุงูููู:* ${totalCost} ุฏุฌ
*ุชูููุฉ ุงูุชูุตูู:* ${deliveryCost} ุฏุฌ
*ุงููุฌููุน ุงููุฑุนู:* ${totalCost - deliveryCost} ุฏุฌ

----------------------------------
*ูููุน ุงูุชูุตูู:*
https://www.google.com/maps/search/?api=1&query=${customerLocation.lat},${customerLocation.lon}
    `;

    // 3. ุชุดููุฑ ุงูุฑุณุงูุฉ ูู URL
    const encodedMessage = encodeURIComponent(message);
    const whatsappURL = `https://wa.me/2135XXXXXXX?text=${encodedMessage}`; // ุงุณุชุจุฏู XXXXXXX ุจุฑููู
    
    // 4. ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุชุฎุฏู
    window.open(whatsappURL, '_blank');
});
    
    
    
    </script>
</body>

</html>
